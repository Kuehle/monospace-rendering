import { createRect, compose } from '../index'
import { reduce } from '../util/array'

const drawStaff = (width: number) => {
    const canvas = createRect({ width, height: 24, char: '.' })
    const line = createRect({ width, height: 1, char: '=' })

    const result = reduce(
        Array(5),
        (result, _, i) => compose(result, line, { y: 4 + i * 4 }),
        canvas
    )

    return result
}

test('draw notes', () => {
    const canvas = drawStaff(60)

    expect(canvas).toEqual([
        '............................................................',
        '............................................................',
        '............................................................',
        '............................................................',
        '============================================================',
        '............................................................',
        '............................................................',
        '............................................................',
        '============================================================',
        '............................................................',
        '............................................................',
        '............................................................',
        '============================================================',
        '............................................................',
        '............................................................',
        '............................................................',
        '============================================================',
        '............................................................',
        '............................................................',
        '............................................................',
        '============================================================',
        '............................................................',
        '............................................................',
        '............................................................',
    ])

    const noteHead = [
        '   ███████  ',
        ' ██       ██',
        '██       ██ ',
        '  ███████   ',
    ]

    const result = compose(canvas, noteHead, {x: 8, y: 17})

    expect(result).toMatchInlineSnapshot()
})
